Note: to do this in place, please swap first and then invert, doing this at the same time could cause hideous bug. I'll leave it to you to think about the bug.
